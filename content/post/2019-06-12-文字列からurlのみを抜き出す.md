---
title: 文字列からURLのみを抜き出す
author: pg1965
type: post
date: 2019-06-12T11:16:21+00:00
url: /2019/06/12/文字列からurlのみを抜き出す/
keni_layout_post:
  - layout-basic
keni_layout_post_sidebar:
  - layout-sidebar-basic
keni_layout_post_footer01:
  - layout-footer-show
keni_layout_post_footer02:
  - layout-footer-show
keni_layout_post_footer03:
  - layout-footer-show
keni_layout_post_navigation:
  - layout-navigation-show
keni_layout_post_breadcrumb:
  - layout-breadcrumb-show
keni_primary_category_post:
  - 8
keni_relation_post:
  - 'a:0:{}'
pvc_views:
  - 2
categories:
  - Excel VBA

---
<pre class="lang:vb decode:true ">'VBScript.RegExpオブジェクトを使ってvbaで正規表現を使う。但し、(…)でグループ化した部分を参照する、RegExp.$n は使えない。
'「Microsoft VBScript Regular Expression 5.5」のライブラリ参照でアーリーバインドできる。
'ex.)文字列からURLを抜き出す。
Dim re As Object
Dim rslt() As Object
Dim url As Object
	Set re = CreateObject("VBScript.RegExp")
	re.Pattern = "https?:\/\/([\w-]+\.)+[\w-]+(\/[\w-.\/?%&=]*)?"
	re.IgnoreCase = True
	re.Global = True
	Set rslt = re.Execute("google:http://www.google.co.jp/,yahoo:http://www.yahoo.co.jp/")
	For Each url In rslt
		MsgBox url
	Next
	'rsltはコレクションなのでrslt(0)という記述もOK</pre>

&nbsp;