---
title: セルの範囲をヴァリアント型配列に格納後、再度セルに戻す（高速化）
author: pg1965
type: post
date: 2019-06-12T09:08:34+00:00
url: /2019/06/12/セルの範囲をヴァリアント型配列に格納後、再度/
keni_layout_post:
  - layout-basic
keni_layout_post_sidebar:
  - layout-sidebar-basic
keni_layout_post_footer01:
  - layout-footer-show
keni_layout_post_footer02:
  - layout-footer-show
keni_layout_post_footer03:
  - layout-footer-show
keni_layout_post_navigation:
  - layout-navigation-show
keni_layout_post_breadcrumb:
  - layout-breadcrumb-show
keni_primary_category_post:
  - 8
keni_relation_post:
  - 'a:0:{}'
pvc_views:
  - 3
categories:
  - Excel VBA

---
<pre class="lang:vb decode:true ">Sub Test6()
    Dim i As Long, B As Variant
    ReDim B(9999, 0)
    For i = 2 To 10001
        B(i - 2, 0) = WorksheetFunction.VLookup(Cells(i, 1), Range("D2:E6"), 2, False)
    Next i
    Range("B2:B10001") = B
End Sub</pre>

エクセルのセルを使った操作は少ない件数の内は気にならないが、数百、数千件の処理となるともの凄く重くなる。そんな時にこの方法を使うと幸せになれます。