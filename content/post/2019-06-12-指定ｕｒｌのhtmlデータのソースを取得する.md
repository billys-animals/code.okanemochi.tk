---
title: 指定ＵＲＬのHTMLデータのソースを取得する
author: pg1965
type: post
date: 2019-06-12T11:30:14+00:00
url: /2019/06/12/指定ｕｒｌのhtmlデータのソースを取得する/
keni_layout_post:
  - layout-basic
keni_layout_post_sidebar:
  - layout-sidebar-basic
keni_layout_post_footer01:
  - layout-footer-show
keni_layout_post_footer02:
  - layout-footer-show
keni_layout_post_footer03:
  - layout-footer-show
keni_layout_post_navigation:
  - layout-navigation-show
keni_layout_post_breadcrumb:
  - layout-breadcrumb-show
keni_primary_category_post:
  - 8
keni_relation_post:
  - 'a:0:{}'
pvc_views:
  - 2
categories:
  - Excel VBA

---
<pre class="lang:vb decode:true ">Function getHtmlSource(ByVal strUrl As String) As String

    Dim xmlHttp As New MSXML2.XMLHTTP30
    Dim response As String
            
    Call sleep(2)
    
    xmlHttp.Open "GET", strUrl, False
            xmlHttp.send
    
    '安定するまでちゃんと待つ
    While xmlHttp.readyState &lt;&gt; 4
        xmlHttp.waitForResponse 600
    Wend
       
    response = xmlHttp.responseText
    response = Trim(Replace(response, vbCrLf, "", , , vbTextCompare))
    response = Trim(Replace(response, vbCr, "", , , vbTextCompare))
    response = Trim(Replace(response, vbLf, "", , , vbTextCompare))

    'getHtmlSource = Left$(response, 6000)
    getHtmlSource = response
End Function

</pre>

&nbsp;