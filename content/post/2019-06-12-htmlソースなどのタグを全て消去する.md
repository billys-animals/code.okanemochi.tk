---
title: HTMLソースなどのタグを全て消去する
author: pg1965
type: post
date: 2019-06-12T11:22:02+00:00
url: /2019/06/12/htmlソースなどのタグを全て消去する/
keni_layout_post:
  - layout-basic
keni_layout_post_sidebar:
  - layout-sidebar-basic
keni_layout_post_footer01:
  - layout-footer-show
keni_layout_post_footer02:
  - layout-footer-show
keni_layout_post_footer03:
  - layout-footer-show
keni_layout_post_navigation:
  - layout-navigation-show
keni_layout_post_breadcrumb:
  - layout-breadcrumb-show
keni_primary_category_post:
  - 8
keni_relation_post:
  - 'a:0:{}'
pvc_views:
  - 2
categories:
  - Excel VBA

---
<pre class="lang:vb decode:true ">Public Function del_html_all_tags(strRef As String) As String

    Dim objRE      As Object
    Dim strPattern As String


    Set objRE = CreateObject("VBScript.RegExp")
    strPattern = "&lt;[^&gt;]+&gt;"

    If (InStr(1, strRef, "&lt;br&gt;", vbTextCompare) &gt; 0) Then
        strRef = Replace(strRef, "&lt;br&gt;", Chr(10))
    End If
    
    strRef = Replace(strRef, " ", "")
    strRef = Replace(strRef, "  ", "")

    
    With objRE
        .Pattern = strPattern       ''検索パターンを設定
        .IgnoreCase = True          ''大文字と小文字を区別しない
        .Global = True              ''文字列全体を検索
        'タグ削除（商品説明＆仕様）
        strRef = .Replace(strRef, vbNullString)
    End With

    strRef = RTrim(LTrim(strRef))

    del_html_all_tags = Trim(strRef)
    
End Function</pre>

&nbsp;