---
title: 指定した文字列をSHIFT_JIS形式に変換する
author: pg1965
type: post
date: 2019-06-12T11:35:34+00:00
url: /2019/06/12/指定した文字列をshift_jis形式に変換する/
keni_layout_post:
  - layout-basic
keni_layout_post_sidebar:
  - layout-sidebar-basic
keni_layout_post_footer01:
  - layout-footer-show
keni_layout_post_footer02:
  - layout-footer-show
keni_layout_post_footer03:
  - layout-footer-show
keni_layout_post_navigation:
  - layout-navigation-show
keni_layout_post_breadcrumb:
  - layout-breadcrumb-show
keni_primary_category_post:
  - 8
keni_relation_post:
  - 'a:0:{}'
pvc_views:
  - 2
categories:
  - Excel VBA

---
<pre class="lang:vb decode:true  ">Function getConvShift_jis(ByVal strMoji As String) As String

    If (strMoji &lt;&gt; "") Then
    
     Dim n As Integer, m As Integer, buf As String
     n = FreeFile                            '１を返します
       
    Open ActiveWorkbook.Path & "\temp1.txt" For Output As n
    Print #n, strMoji
    Close n
     
        
    res = GetCharSetOfText(ActiveWorkbook.Path, "temp1")
    'Res = WorksheetFunction.code(strMoji)
        With New ADODB.stream
        
            .Open
            .Type = adTypeText
            .WriteText strMoji
            .Position = 0
            .charset = "x-sjis"
            getConvShift_jis = .ReadText
            .Close
        End With
    End If
    
    Kill ActiveWorkbook.Path & "\temp1.txt"

End Function

</pre>